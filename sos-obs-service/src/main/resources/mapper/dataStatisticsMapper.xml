<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sensorweb.sosobsservice.dao.dataStatisticsMapper" >
  <resultMap id="BaseResultMap" type="com.sensorweb.sosobsservice.entity.dataStatistics" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Sep 16 15:56:33 CST 2022.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="job_id" property="jobId" jdbcType="VARCHAR" />
    <result column="statistics" property="statistics" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Sep 16 15:56:33 CST 2022.
    -->
    delete from data_item_statistics
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.sensorweb.sosobsservice.entity.dataStatistics" useGeneratedKeys="true" keyProperty="id">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Sep 16 15:56:33 CST 2022.
      useGeneratedKeys="true" keyProperty="id"
    -->
    insert into data_item_statistics ( job_id, statistics,
      create_time)
    values ( #{jobId,jdbcType=VARCHAR}, #{statistics,jdbcType=VARCHAR},
      #{createTime,jdbcType=TIMESTAMP})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.sensorweb.sosobsservice.entity.dataStatistics" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Sep 16 15:56:33 CST 2022.
    -->
    update data_item_statistics
    set job_id = #{jobId,jdbcType=VARCHAR},
      statistics = #{statistics,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Sep 16 15:56:33 CST 2022.
    -->
    select id, job_id, statistics, create_time
    from data_item_statistics
    where id = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Sep 16 15:56:33 CST 2022.
    -->
    select id, job_id, statistics, create_time
    from data_item_statistics
  </select>

<!--  查询开始-->

  <select id="getHBAirNumByTime" resultType="java.lang.Integer">
    SELECT  count(*)
    FROM "wuhanCC_air_hourly"
    WHERE querytime <![CDATA[>=]]> #{begin} AND querytime <![CDATA[<=]]> #{end}
  </select>

  <select id="getHBAirNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM "wuhanCC_air_hourly"
  </select>


  <select id="getCHAirNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM china_air_hourly
  </select>

  <select id="getCHAirNumByTime" resultType="java.lang.Integer">
    SELECT  count(*)
    FROM china_air_hourly
    WHERE time_point <![CDATA[>=]]> #{begin} AND time_point <![CDATA[<=]]> #{end}
  </select>

  <select id="getTWAirNumByTime" resultType="java.lang.Integer">
    SELECT  count(*)
    FROM taiwan_air_hourly
    WHERE tw_time <![CDATA[>=]]> #{begin} AND tw_time <![CDATA[<=]]> #{end}
  </select>
  <select id="getTWAirNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM taiwan_air_hourly
  </select>
  <select id="getSuperAirNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM "wuhanCC_super_station_hourly"
  </select>
  <select id="getSuperAirNumByTime" resultType="java.lang.Integer">
    SELECT  count(*)
    FROM "wuhanCC_super_station_hourly"
    WHERE "TIMES" <![CDATA[>=]]> #{begin} AND "TIMES" <![CDATA[<=]]> #{end}
  </select>
  <select id="getWaterNumByTime" resultType="java.lang.Integer">
    SELECT  count(*)
    FROM hb_water_hourly
    WHERE "dataTime" <![CDATA[>=]]> #{begin} AND "dataTime" <![CDATA[<=]]> #{end}
  </select>
  <select id="getWaterNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM hb_water_hourly
  </select>

  <select id="getWaterQualityNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM hb_waterpollution
  </select>
  <select id="getWaterPollutionNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM wh_water_quality
  </select>

  <select id="getWaterQualityAutoNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM wh_water_quality_auto
  </select>

  <select id="getGFNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM gf
  </select>

  <select id="getWeatherNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM "wuhanCC_weather_hourly"
    WHERE "QueryTime" <![CDATA[>=]]> #{begin} AND "QueryTime" <![CDATA[<=]]> #{end}
  </select>
  <select id="getWeatherNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM "wuhanCC_weather_hourly"
  </select>
  <select id="getCHWeatherNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM china_meteorological_network
    WHERE time <![CDATA[>=]]> #{begin} AND time <![CDATA[<=]]> #{end}
  </select>
  <select id="getCHWeatherNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM china_meteorological_network
  </select>
  <select id="getHBWeatherNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM hb_weather_station_hourly
    WHERE response_time <![CDATA[>=]]> #{begin} AND response_time <![CDATA[<=]]> #{end}
  </select>
  <select id="getHBWeatherNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM hb_weather_station_hourly
  </select>
  <select id="getModisNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM entry
    WHERE start_time <![CDATA[>=]]> #{begin} AND start_time <![CDATA[<]]> #{end}
  </select>
  <select id="getModisNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM entry
  </select>
  <select id="getGPMNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM gpm_3imergde
    WHERE time <![CDATA[>=]]> #{begin} AND time <![CDATA[<=]]> #{end}
  </select>
  <select id="getGPMNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM gpm_3imergde
  </select>
  <select id="getGLDASNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM gldas
    WHERE time <![CDATA[>=]]> #{begin} AND time <![CDATA[<=]]> #{end}
  </select>
  <select id="getGLDASNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM gldas
  </select>
  <select id="getLandsatNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM landsat
    WHERE  date <![CDATA[>=]]> #{begin} AND date <![CDATA[<]]> #{end}
  </select>
  <select id="getLandsatNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM landsat
  </select>
  <select id="getHimawariNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM himawari
    WHERE h_time <![CDATA[>=]]> #{begin} AND h_time <![CDATA[<=]]> #{end}
  </select>
  <select id="getHimawariNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM himawari
  </select>

  <select id="getMailDataNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM maildata
  </select>

  <select id="getUAVNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM uav_image
    WHERE create_time <![CDATA[>=]]> #{begin} AND create_time <![CDATA[<=]]> #{end}
  </select>
  <select id="getUAVNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM uav_image
  </select>
  <select id="getFYNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM satellite_image
    WHERE time <![CDATA[>=]]> #{begin} AND time <![CDATA[<=]]> #{end}
  </select>
  <select id="getFYNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM satellite_image
  </select>
  <select id="getTXZNumByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM tianxingzhou_station
    WHERE querytime <![CDATA[>=]]> #{begin} AND querytime <![CDATA[<=]]> #{end}
  </select>
  <select id="getTXZNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM tianxingzhou_station
  </select>

    <select id="getProductTypeNum" resultType="java.lang.Integer">
      select count(*) from product_type where module = #{type}
    </select>


  <select id="getProductNum" resultType="java.lang.Integer">
    select count(*) from tmodule a left join order_file b on a.name = b.product_type where type = #{type}
  </select>

  <select id="getInterfaceNum" resultType="java.lang.Integer" >
    select count(*) from resource where type = #{type}
  </select>

  <select id="getFilepath" resultType="java.lang.String">
    select dir_path from data_storage where type = #{type} and storage = #{database}
  </select>

  <select id="getDatabaseSize" resultType="java.lang.Long">
    select pg_relation_size(#{table})
  </select>

  <select id="getProductNumByTime" resultType="java.lang.Integer">
    select count(*) from tmodule a left join order_file b on a.name = b.product_type where type = #{type} and create_time <![CDATA[>=]]> #{begin} AND create_time <![CDATA[<=]]> #{end}
  </select>
    <select id="getProductNumByTime2" resultType="java.lang.Integer">
      select count(*) from tmodule a left join order_file b on a.name = b.product_type where type = #{type} AND create_time <![CDATA[<=]]> #{end}
    </select>

    <select id="getFilepath2" resultType="java.lang.String" parameterType="java.lang.String">
      select dir_path from data_storage where storage = #{database}
    </select>

    <select id="getwaterAutoNum" resultType="java.lang.Integer">
      SELECT count(*)
      FROM wh_water_quality_auto
    </select>
  <select id="getyaEBNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM "yangtzeRiverEB_weather"
  </select>

  <select id="getyaMRNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM "yangtzeRiverMR_weather"
  </select>

  <select id="getSentinelNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM sentinel
  </select>
  <select id="getCopernicusNum" resultType="java.lang.Integer">
    SELECT count(*)
    FROM cams
  </select>


  <select id="getSentineByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM sentinel
    WHERE date <![CDATA[>=]]> #{begin} AND date <![CDATA[<=]]> #{end}
  </select>


  <select id="getCopernicus" resultType="java.lang.Integer">
    SELECT count(*)
    FROM cams
    WHERE time <![CDATA[>=]]> #{begin} AND time <![CDATA[<=]]> #{end}
  </select>


    <select id="getLittleSensorNumber" resultType="java.lang.Integer">
      SELECT count(*)
      FROM sensors_data_copy1
    </select>

  <select id="getNumberByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM sensors_data_copy1
    WHERE sample_time <![CDATA[>=]]> #{begin} AND sample_time <![CDATA[<=]]> #{end}
  </select>


  <select id="getWeatherSensorNumber" resultType="java.lang.Integer">
    SELECT count(*)
    FROM big_sensors_data
  </select>

  <select id="getWeatherSensorByTime" resultType="java.lang.Integer">
    SELECT count(*)
    FROM big_sensors_data
    WHERE sample_time <![CDATA[>=]]> #{begin} AND sample_time <![CDATA[<=]]> #{end}
  </select>


    <select id="getTodayNumber" resultType="java.lang.Integer" parameterType="java.time.Instant">
      select sum(total) as total
      from push_data
      where create_time <![CDATA[>=]]> #{time}
    </select>

</mapper>